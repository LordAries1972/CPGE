// *----------------------------------------------------------------------------------------------
// Program Start!
// *----------------------------------------------------------------------------------------------
int APIENTRY WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nCmdShow)
{
	// Initialise and create a window
	
	...
	
	// Initialise our TTS Manager
	if (!ttsManager.Initialize()) {
		debug.logLevelMessage(LogLevel::LOG_WARNING, L"TTS system initialization failed - continuing without TTS");
	}
	else {
		#if defined(_DEBUG_TTSMANAGER_) && defined(_DEBUG)
			debug.logLevelMessage(LogLevel::LOG_INFO, L"TTS system initialized successfully");
		#endif
	}
	
	// Examples of use :-
	
	// Example 1: Basic text-to-speech
	ttsManager.Play(L"Welcome to the game!");

	// Example 2: Asynchronous speech with custom settings
	ttsManager.SetVoiceVolume(0.8f);           // 80% volume
	ttsManager.SetVoicePitch(2.0f);            // Higher pitch
	ttsManager.SetVoiceRate(-2.0f);            // Slower speech
	ttsManager.SetSpeakerChannel(TTSSpeakerChannel::CHANNEL_LEFT);  // Left speaker only
	ttsManager.PlayAsync(L"Loading game assets, please wait...");

	// Example 3: Voice control during gameplay
	if (ttsManager.IsPlaying()) {
		ttsManager.Pause();                     // Pause current speech
	}

	// Later...
	ttsManager.Resume();                        // Resume paused speech

	// Example 4: Emergency stop
	ttsManager.Stop();                          // Stop immediately

	// Example 5: Voice selection
	std::vector<std::wstring> voices = ttsManager.GetAvailableVoices();
	if (!voices.empty()) {
		ttsManager.SetVoiceByName(voices[0]);   // Use first available voice
	}

	// Example 6: Channel-specific announcements
	ttsManager.SetSpeakerChannel(TTSSpeakerChannel::CHANNEL_RIGHT);
	ttsManager.Play(L"Enemy approaching from the right!");

	ttsManager.SetSpeakerChannel(TTSSpeakerChannel::CHANNEL_LEFT);
	ttsManager.Play(L"Power-up available on the left!");

	ttsManager.SetSpeakerChannel(TTSSpeakerChannel::CHANNEL_BOTH);
	ttsManager.Play(L"Game over!");

    while (ttsManager.IsPlaying())
	{
		Sleep(25);
	}
	
	ttsManager.Stop();                          // Stop immediately

    // Destroy and release resources.
	ttsManager.CleanUp();
}

void SwitchToGamePlay()
{
    // Add TTS announcement for gameplay start
    if (ttsManager.GetPlaybackState() != TTSPlaybackState::STATE_ERROR) {
        ttsManager.SetSpeakerChannel(TTSSpeakerChannel::CHANNEL_BOTH);
        ttsManager.SetVoiceVolume(0.7f);
        ttsManager.PlayAsync(L"Starting gameplay!");
    }
    
    scene.SetGotoScene(SCENE_GAMEPLAY);
    scene.InitiateScene();
    scene.SetGotoScene(SCENE_NONE);
    // Restart the Loader Thread to load in required assets.
    renderer->ResumeLoader();
}

void SwitchToMovieIntro()
{
    // Add TTS announcement for movie intro
    if (ttsManager.GetPlaybackState() != TTSPlaybackState::STATE_ERROR) {
        ttsManager.SetSpeakerChannel(TTSSpeakerChannel::CHANNEL_BOTH);
        ttsManager.SetVoiceVolume(0.6f);
        ttsManager.PlayAsync(L"Playing introduction movie");
    }
    
    scene.SetGotoScene(SCENE_INTRO_MOVIE);
    scene.InitiateScene();
    scene.SetGotoScene(SCENE_NONE);
    fxManager.FadeToImage(3.0f, 0.06f);
    OpenMovieAndPlay();
    // Restart the Loader Thread to load in required assets.
    renderer->ResumeLoader();
}